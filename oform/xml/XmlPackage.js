/*
 * (c) Copyright Ascensio System SIA 2010-2019
 *
 * This program is a free software product. You can redistribute it and/or
 * modify it under the terms of the GNU Affero General Public License (AGPL)
 * version 3 as published by the Free Software Foundation. In accordance with
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect
 * that Ascensio System SIA expressly excludes the warranty of non-infringement
 * of any third-party rights.
 *
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html
 *
 * You can contact Ascensio System SIA at 20A-12 Ernesta Birznieka-Upisha
 * street, Riga, Latvia, EU, LV-1050.
 *
 * The  interactive user interfaces in modified source and object code versions
 * of the Program must display Appropriate Legal Notices, as required under
 * Section 5 of the GNU AGPL version 3.
 *
 * Pursuant to Section 7(b) of the License you must retain the original Product
 * logo when distributing the program. Pursuant to Section 7(e) we decline to
 * grant you any rights under trademark law for use of our trademarks.
 *
 * All the Product's GUI elements, including illustrations and icon sets, as
 * well as technical writing content are licensed under the terms of the
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode
 *
 */

"use strict";

(function(window)
{
	/**
	 * Класс для работы с форматом oform в xml
	 * @constructor
	 * @extends {AscCommon.openXml.OpenXmlPackage}
	 */
	function XmlPackage(zip, writer)
	{
		AscCommon.openXml.OpenXmlPackage.apply(this, arguments);
		
		this.context = new AscOForm.XmlContext(this);
	}
	XmlPackage.prototype = Object.create(AscCommon.openXml.OpenXmlPackage.prototype);
	XmlPackage.prototype.constructor = XmlPackage;
	XmlPackage.prototype.openFromZip = function()
	{
		let zip = this.zip;
		let pkg = this;
		zip.files.forEach(function(path)
		{
			if (!path.endsWith("/"))
			{
				var f2 = "/" + path;
				var contentType = null;
				if (path !== "[Content_Types].xml")
				{
					f2 = "/" + path;
					contentType = pkg.getContentType(f2);
				}
				pkg.parts[f2] = new AscCommon.openXml.OpenXmlPart(pkg, f2, contentType);
			}
		});
	};
	XmlPackage.prototype.getMainPart = function()
	{
		return this.parts["/main.xml"];
	};
	XmlPackage.prototype.getContext = function()
	{
		return this.context;
	};
	
	//--------------------------------------------------------export----------------------------------------------------
	AscOForm.XmlPackage = XmlPackage;
	
	AscOForm.Test = function()
	{
		let bse64Zip = "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";
		var dstLen = bse64Zip.length;
		var pointer = g_memory.Alloc(dstLen);
		var stream = new AscCommon.FT_Stream2(pointer.data, dstLen);
		stream.obj = pointer.obj;
		
		var oBinaryFileReader = new AscCommonExcel.BinaryFileReader();
		oBinaryFileReader.getbase64DecodedData2(bse64Zip, 0, stream, 0);
		
		let jsZlib = new AscCommon.ZLib();
		if (jsZlib.open(new Uint8Array(pointer.data)))
		{
			let xmlPkg = new XmlPackage(jsZlib);

			let logicDocument = editor.WordControl.m_oLogicDocument;
			let oform = logicDocument.GetOFormDocument();
			let oformDocument = oform.getFormat();
			
			oformDocument.fromPkg(xmlPkg)
			
			console.log(oform);
		}
		
	}
	
})(window);
